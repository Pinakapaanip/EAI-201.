import pandas as pd
import numpy as np

file_path = r"C:\Users\LUCKY\OneDrive\Desktop\Y31\Documents\Desktop\FIFA World Cup 1930-2022 All Match Dataset.csv"
df = pd.read_csv(file_path, encoding='latin1')

print("Initial dataset shape:", df.shape)
print(df.head())

df.drop_duplicates(inplace=True)
df.reset_index(drop=True, inplace=True)

print("\nMissing values per column:")
print(df.isnull().sum())

df.dropna(subset=['Match Date', 'Home Team Name', 'Away Team Name', 'Home Team Score', 'Away Team Score'], inplace=True)

df['Goal Difference'] = df['Home Team Score'] - df['Away Team Score']

def match_result(row):
    if row['Home Team Score'] > row['Away Team Score']:
        return 'Home Win'
    elif row['Home Team Score'] < row['Away Team Score']:
        return 'Away Win'
    else:
        return 'Draw'

df['Result'] = df.apply(match_result, axis=1)
df['Year'] = pd.to_datetime(df['Match Date']).dt.year

cleaned_file_path = r"C:\Users\LUCKY\OneDrive\Desktop\Y31\Documents\Desktop\FIFA_WC_Cleaned.csv"
df.to_csv(cleaned_file_path, index=False, encoding='utf-8')
print("\nCleaned dataset saved to:", cleaned_file_path)

print("\nCleaned dataset shape:", df.shape)
print(df.head())
print("\nValue counts of match results:")
print(df['Result'].value_counts())
